秘钥的分配与秘钥管理

单钥加密体制的秘钥分配
 1. 密钥分配的基本方法
 两个用户A和B获得共享密钥的方法

（1）密钥由A选取并通过物理手段发送给B
（2）密钥通过第三方选取并通过物理手段发送给A和B
如果有n个用户，则密钥数目为n(n-1)/2  n很大时，密钥分配的代价比较大
（3）如果A,B事先已有一个密钥，则其中一方选取新密钥后，用已有的密钥加密新密钥并发送给另外一方
攻击者一旦获得一个密钥就可以获得以后所有的密钥
对所有用户分配初始密钥时，代价比较大 

（4）如果A B 在第三方C分别有一保密通道，则C为AB选取密钥后，分别在两个保密信道上发送给AB
每一用户必须和第三方（密钥分配中心KDC key distribution center）有一个共享密钥，称为主密钥。通过主密钥分配给一对用户的密钥称为会话密钥，会话密钥的数目n(n-1)/2
主密钥只需要n个，所以主密钥可以通过物理手段发送。

2. 密钥的分层控制

网络中如果用户数目非常多而且分布的地域非常广，一个KDC 就无法承担为用户分配密钥的重任。问题的解决方法是使用多个KDC的分层结构。例如，在每个小范围（如一个LAN或一个建筑物）内，都建立一个本地KDC。同一范围的用户在进行保密通信时，由本地KDC为他们分配密钥。如果两个不同范围的用户想获得共享密钥，则可通过各自的本地KDC，而两个本地 KDC的沟通又需经过一个全局KDC。这样就建立了两层KDC。 类似地，根据网络中用户的数目及分布的地域，可建立3层或多层KDC.

3.会话密钥的有效期
系统安全性随着密钥更新频率的增大而增大。系统效率随着密钥更新频率的增大而减小。
所以密钥的更新周期既不能太短也不能太长。

对面向连接的协议，在连接未建立前或断开时，会话密钥的 有效期可以很长。而每次建立连接时，都应使用新的会话密钥。 如果逻辑连接的时间很长，则应定期更换会话密钥。
无连接协议（如面向业务的协议），无法明确地决定更换密钥的频率。

为安全起见，用户每进行一次交换，都用新的会话密钥。 然而这又失去了无连接协议主要的优势，即对每个业务都有最少的费用和最短的延迟

比较好的方案是在某一固定周期内或对一定数目的业务使用同一会话密钥。


4.无中心的密钥控制

用密钥分配中心为用户分配密钥时，要求所有用户都信任 KDC，同时还要求对KDC加以保护。

如果密钥的分配是无中心的，则不必有以上两个要求。 然而如果每个用户都能和自己想与之建立联系的另一用户 安全地通信，则对有n个用户的网络来说，主密钥应多达 n(n-1)/2个。当n很大时，这种方案无实用价值，但在整个 网络的局部范围却非常有用。
无中心的密钥分配时，两个用户A和B建立会话密钥需经过以下3步：

	1 A向B发出建立会话密钥的请求和一个一次性随机数'。

	2 B用与A共享的主密钥MKm对应答的消息加密，并发送给A。 应答的消息中有B选取的会话密钥、B的身份、f(NJ和另一个 一次性随机数N2。

	3 A使用新建立的会话密钥Kf(N2)加密后返回给B。

5.密钥的控制使用
密钥可根据其不同用途分为会话密钥和主密钥两种类型， 会话密钥又称为数据加密密钥，主密钥又称为密钥加密密钥。

由于密钥的用途不同，因此对密钥的使用方式也希望加 以某种控制。

如果主密钥泄露了，则相应的会话密钥也将泄露，因此主 密钥的安全性应高于会话密钥的安全性。

一般在密钥分配中心以及终端系统中主密钥都是物理上安 全的，如果把主密钥当作会话密钥注入加密设备，那么其安 全性则降低。



单钥体制中的密钥控制技术有以下两种。

(1)密钥标签

用于DES的密钥控制，将DES的64比特密钥中的8个校验位作为控制使用这一密钥的标签。标签中各比特的含义为：

一个比特表示这个密钥是会话密钥还是主密钥；

一个比特表示这个密钥是否能用于加密；

一个比特表示这个密钥是否能用于解密；

其他比特无特定含义，留待以后使用。


由于标签是在密钥之中，在分配密钥时，标签与密钥一起被 加密，因此可对标签起到保护作用。

本方案的缺点：

第一，标签的长度被限制为8比特，限制了它的灵活性和功能;

第二，由于标签是以密文形式传送,只有解密后才能使用，因而限制了对密钥使用的控制方式

(2)控制矢量
方案中对每一会话密钥都指定了一个相应的控制矢量，控制矢量分为若干字段，分别用于说明在不同情况下密钥是被允许使用还是不被允许使用，且控制矢量的长度可变。



公钥加密体制的秘钥管理